<!-- Replace the entire <script> block in your index.html with this -->
<script>
    const apiUrl = "/api/quotes";

    // Load all quotes
    async function loadQuotes() {
        try {
            const res = await fetch(apiUrl);
            if (!res.ok) throw new Error("Failed to fetch quotes");

            const data = await res.json();
            const container = document.getElementById("quotes-container");
            container.innerHTML = "";

            if (data.length === 0) {
                container.innerHTML = "<p class='text-muted text-center'>No quotes yet. Be the first to add one!</p>";
                return;
            }

            data.forEach(q => {
                const div = document.createElement("div");
                div.className = "card mb-3";
                div.innerHTML = `
                    <div class="card-body">
                        <blockquote class="blockquote mb-0">
                            <p>${q.text}</p>
                            <footer class="blockquote-footer">${q.author || "Unknown"}</footer>
                            <div class="mt-2">
                                <span class="badge bg-secondary me-2">Likes: ${q.likes}</span>
                                <button class="btn btn-sm btn-outline-primary" onclick="likeQuote(${q.id})">Like</button>
                            </div>
                        </blockquote>
                    </div>
                `;
                container.appendChild(div);
            });

        } catch (err) {
            console.error("Error loading quotes:", err);
        }
    }

    // Submit quote form
    document.getElementById("quote-form").addEventListener("submit", async function (e) {
        e.preventDefault();

        const quote = {
            text: document.getElementById("quoteText").value,
            author: document.getElementById("quoteAuthor").value
        };

        try {
            const res = await fetch(apiUrl, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(quote)
            });

            if (res.ok) {
                this.reset();
                await loadQuotes();
            } else {
                console.error("Failed to add quote:", await res.text());
            }
        } catch (err) {
            console.error("Error sending quote:", err);
        }
    });

    // Handle like
    async function likeQuote(id) {
        try {
            const res = await fetch(`${apiUrl}/${id}/like`, {
                method: "POST"
            });

            if (res.ok) {
                await loadQuotes(); // refresh list after liking
            } else {
                console.error("Failed to like quote:", await res.text());
            }
        } catch (err) {
            console.error("Error liking quote:", err);
        }
    }

    // Load quotes on initial page load
    loadQuotes();
</script>
